================================================================================
            TUTORIAL DE INSTALAÃ‡ÃƒO - ANDROID STREAM MANAGER
================================================================================

Este tutorial guia a instalaÃ§Ã£o completa do Android Stream Manager no WSL Ubuntu.

ðŸŽ¯ OBJETIVO: Sistema de gerenciamento remoto de dispositivos Android funcional

================================================================================
PASSO 1: PREPARAÃ‡ÃƒO DO AMBIENTE WSL UBUNTU
================================================================================

1.1 Verificar versÃ£o do Ubuntu no WSL:
    lsb_release -a
    # Deve ser Ubuntu 20.04 ou superior

1.2 Atualizar o sistema:
    sudo apt update && sudo apt upgrade -y

1.3 Instalar ferramentas bÃ¡sicas:
    sudo apt install -y \
        git \
        curl \
        wget \
        build-essential \
        cmake \
        ninja-build \
        pkg-config \
        software-properties-common \
        apt-transport-https \
        ca-certificates \
        gnupg \
        lsb-release \
        libsqlite3-dev

================================================================================
PASSO 2: INSTALAÃ‡ÃƒO DAS DEPENDÃŠNCIAS DO SISTEMA
================================================================================

2.1 Bibliotecas essenciais:
    sudo apt install -y \
        libssl-dev \
        zlib1g-dev \
        liblz4-dev \
        libzip-dev \
        libjwt-dev \
        uuid-dev

2.2 Qt6 para o Dashboard (interface grÃ¡fica):
    sudo apt install -y \
        qt6-base-dev \
        qt6-tools-dev \
        qt6-multimedia-dev \
        qt6-declarative-dev

2.3 Ferramentas de desenvolvimento:
    sudo apt install -y \
        clang \
        clang-format \
        clang-tidy \
        valgrind \
        gdb \
        doxygen \
        graphviz

2.4 Verificar se as dependÃªncias foram instaladas:
    pkg-config --list-all | grep -E "(ssl|zlib|lz4|zip|jwt|qt6)"

================================================================================
PASSO 3: CLONAR E PREPARAR O PROJETO
================================================================================

3.1 Clonar o repositÃ³rio:
    git clone https://github.com/seu-usuario/android-stream-manager.git
    cd android-stream-manager

3.2 Verificar estrutura do projeto:
    ls -la
    # Deve conter: core/, security/, optimization/, android-client-template/, etc.

3.3 Dar permissÃµes de execuÃ§Ã£o aos scripts:
    chmod +x scripts/*.sh
    chmod +x tutorial-install-linux.sh

================================================================================
PASSO 4: BUILD BÃSICO (TESTE RÃPIDO)
================================================================================

4.1 Build da biblioteca core (teste rÃ¡pido):
    make build

    # SaÃ­da esperada:
    # Compilando core/system_manager.cpp...
    # Compilando core/apk_builder.cpp...
    # Compilando optimization/stream_optimizer.cpp...
    # Criando biblioteca core...
    # ar: creating lib/libcore.a

4.2 Verificar se o build foi bem-sucedido:
    ls -la lib/
    # Deve conter: libcore.a

4.3 Executar teste bÃ¡sico:
    make test

    # SaÃ­da esperada:
    # === Testes do Android Stream Manager ===
    # === Teste ThreadPool ===
    # === Teste StreamOptimizer ===
    # === Teste BuildCache ===
    # === Todos os testes concluÃ­dos ===

================================================================================
PASSO 5: BUILD COMPLETO COM CMAKE
================================================================================

5.1 Criar diretÃ³rio de build:
    mkdir -p build
    cd build

5.2 Configurar com CMake:
    cmake .. \
        -DCMAKE_BUILD_TYPE=Release \
        -DBUILD_DASHBOARD=ON \
        -DBUILD_APK_BUILDER=ON \
        -DBUILD_TESTS=OFF

5.3 Compilar:
    make -j$(nproc)

5.4 Verificar executÃ¡veis gerados:
    ls -la bin/
    # Deve conter:
    # android_stream_dashboard (se Qt6 instalado)
    # apk_builder
    # stream_server

5.5 Executar dashboard Qt:
    cd bin
    ./android_stream_dashboard

    # Interface grÃ¡fica serÃ¡ aberta com:
    # - Lista de dispositivos conectados
    # - ConfiguraÃ§Ã£o de APK
    # - HistÃ³rico de builds
    # - Logs do sistema
    # - Controles de streaming (servidor principal)

================================================================================
PASSO 6: CONFIGURAÃ‡ÃƒO DO ANDROID SDK (OPCIONAL - PARA BUILD DE APKS)
================================================================================

6.1 Criar diretÃ³rio do Android SDK:
    mkdir -p ~/android-sdk
    cd ~/android-sdk

6.2 Baixar Command Line Tools:
    wget https://dl.google.com/android/repository/commandlinetools-linux-9477386_latest.zip

6.3 Extrair e configurar:
    unzip commandlinetools-linux-9477386_latest.zip
    mkdir -p cmdline-tools
    mv cmdline-tools/* cmdline-tools/
    rm commandlinetools-linux-9477386_latest.zip

6.4 Configurar variÃ¡veis de ambiente:
    echo 'export ANDROID_SDK_ROOT="$HOME/android-sdk"' >> ~/.bashrc
    echo 'export ANDROID_HOME="$ANDROID_SDK_ROOT"' >> ~/.bashrc
    echo 'export PATH="$PATH:$ANDROID_SDK_ROOT/cmdline-tools/bin:$ANDROID_SDK_ROOT/platform-tools"' >> ~/.bashrc
    source ~/.bashrc

6.5 Instalar componentes do Android:
    cd ~/android-sdk
    sdkmanager --install "platform-tools"
    sdkmanager --install "platforms;android-33"
    sdkmanager --install "build-tools;33.0.0"
    sdkmanager --install "ndk;25.2.9519653"
    sdkmanager --install "cmake;3.22.1"

6.6 Verificar instalaÃ§Ã£o:
    adb version
    # Deve mostrar versÃ£o do ADB

================================================================================
PASSO 7: CONFIGURAÃ‡ÃƒO DO SISTEMA
================================================================================

7.1 Copiar arquivos de configuraÃ§Ã£o:
    sudo mkdir -p /etc/android-stream-manager
    sudo cp config/system_config.json /etc/android-stream-manager/

7.2 Criar diretÃ³rios necessÃ¡rios:
    sudo mkdir -p \
        /var/lib/android-stream-manager/{apks,cache,sessions} \
        /var/log/android-stream-manager \
        /usr/local/share/android-stream-manager/templates

7.3 Copiar templates (se existirem):
    sudo cp -r templates/* /usr/local/share/android-stream-manager/templates/ 2>/dev/null || true

================================================================================
PASSO 8: INSTALAÃ‡ÃƒO DO SISTEMA (OPCIONAL)
================================================================================

8.1 Instalar biblioteca core:
    sudo make install

8.2 Verificar instalaÃ§Ã£o:
    ls -la /usr/local/lib/libcore.a
    ls -la /usr/local/include/android-stream-manager/

================================================================================
PASSO 9: BUILD DO APK ANDROID
================================================================================

9.1 Entrar no diretÃ³rio do template:
    cd android-client-template

9.2 Verificar se tem Android SDK configurado:
    echo $ANDROID_SDK_ROOT
    # Deve apontar para ~/android-sdk

9.3 Build do APK (modo debug):
    ./gradlew assembleDebug

9.4 Verificar APK gerado:
    ls -la app/build/outputs/apk/debug/
    # Deve conter: app-debug.apk

================================================================================
PASSO 10: TESTE INTEGRADO DO SISTEMA
================================================================================

10.1 Executar dashboard (se Qt6 instalado):
     cd build/bin
     ./android_stream_dashboard

10.2 Testar APK builder:
     cd build/bin
     ./apk_builder --help

10.3 Executar servidor principal:
     cd build/bin
     ./stream_server --help

     # Executar servidor:
     ./stream_server --port 8443

10.4 Testar persistÃªncia de dados:
     # O servidor cria automaticamente stream_manager.db
     ls -la /etc/android-stream-manager/
     # Deve conter: stream_manager.db

     # Verificar tamanho do banco:
     du -h /etc/android-stream-manager/stream_manager.db

10.5 Verificar conectividade de rede:
     # Testar API do servidor
     curl -X GET http://localhost:8443/api/health

     # Ver estatÃ­sticas
     curl -X GET http://localhost:8443/api/stats

     # Listar dispositivos conectados
     curl -X GET http://localhost:8443/api/devices

================================================================================
PASSO 11: INSTALAÃ‡ÃƒO DO APK NO DISPOSITIVO ANDROID
================================================================================

11.1 Conectar dispositivo Android via USB:
     adb devices
     # Deve mostrar dispositivo conectado

11.2 Instalar APK:
     adb install -r android-client-template/app/build/outputs/apk/debug/app-debug.apk

11.3 Conceder permissÃµes (no dispositivo):
     # Abra o app e conceda todas as permissÃµes solicitadas

================================================================================
PROBLEMAS COMUNS E SOLUÃ‡Ã•ES
================================================================================

PROBLEMA 1: "lz4 library not found"
SOLUÃ‡ÃƒO:
    sudo apt install liblz4-dev

PROBLEMA 2: "Qt6 not found"
SOLUÃ‡ÃƒO:
    sudo apt install qt6-base-dev qt6-tools-dev qt6-multimedia-dev

PROBLEMA 3: "Android SDK not found"
SOLUÃ‡ÃƒO:
    Verificar se ANDROID_SDK_ROOT estÃ¡ configurado
    source ~/.bashrc

PROBLEMA 4: "Build falha com erros de SSL"
SOLUÃ‡ÃƒO:
    sudo apt install libssl-dev
    Verificar versÃ£o: pkg-config --modversion libssl

PROBLEMA 5: "CMake nÃ£o encontra bibliotecas"
SOLUÃ‡ÃƒO:
    pkg-config --libs --cflags libssl lz4 libzip
    # Deve mostrar flags de compilaÃ§Ã£o

PROBLEMA 6: "Qt6 interface nÃ£o abre no WSL"
SOLUÃ‡ÃƒO:
    export DISPLAY=:0
    # Ou usar X11 forwarding se configurar X server no Windows

================================================================================
VERIFICAÃ‡ÃƒO FINAL DO SISTEMA
================================================================================

Script de verificaÃ§Ã£o completa:
    #!/bin/bash
    echo "=== VerificaÃ§Ã£o do Android Stream Manager ==="

    # Verificar dependÃªncias
    echo "DependÃªncias:"
    pkg-config --exists libssl && echo "âœ“ OpenSSL" || echo "âœ— OpenSSL"
    pkg-config --exists liblz4 && echo "âœ“ LZ4" || echo "âœ— LZ4"
    pkg-config --exists libzip && echo "âœ“ libzip" || echo "âœ— libzip"
    pkg-config --exists Qt6Core && echo "âœ“ Qt6" || echo "âœ— Qt6"

    # Verificar build
    echo -e "\nBuild:"
    [ -f "lib/libcore.a" ] && echo "âœ“ Biblioteca core" || echo "âœ— Biblioteca core"
    [ -f "build/bin/android_stream_dashboard" ] && echo "âœ“ Dashboard" || echo "âœ— Dashboard"
    [ -f "android-client-template/app/build/outputs/apk/debug/app-debug.apk" ] && echo "âœ“ APK Android" || echo "âœ— APK Android"

    # Verificar Android SDK
    echo -e "\nAndroid SDK:"
    [ -n "$ANDROID_SDK_ROOT" ] && echo "âœ“ ANDROID_SDK_ROOT configurado" || echo "âœ— ANDROID_SDK_ROOT nÃ£o configurado"
    [ -d "$ANDROID_SDK_ROOT/platform-tools" ] && echo "âœ“ Platform tools instalado" || echo "âœ— Platform tools faltando"

    echo -e "\n=== VerificaÃ§Ã£o concluÃ­da ==="

================================================================================
COMANDOS ÃšTEIS PARA DESENVOLVIMENTO
================================================================================

# Build rÃ¡pido
make build && make test

# Build completo
cd build && make -j$(nproc)

# Limpar tudo
make clean

# Formatar cÃ³digo
make format

# AnÃ¡lise estÃ¡tica
make lint

# Status do projeto
make status

# Contar linhas de cÃ³digo
make count

================================================================================
ESTRUTURA FINAL ESPERADA
================================================================================

android-stream-manager/
â”œâ”€â”€ bin/
â”‚   â”œâ”€â”€ android_stream_dashboard    # Interface Qt
â”‚   â””â”€â”€ apk_builder                # Construtor de APKs
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ libcore.a                  # Biblioteca core
â”œâ”€â”€ android-client-template/
â”‚   â””â”€â”€ app/build/outputs/apk/debug/app-debug.apk
â”œâ”€â”€ config/
â”‚   â””â”€â”€ system_config.json
â”œâ”€â”€ /etc/android-stream-manager/
â”‚   â””â”€â”€ system_config.json
â””â”€â”€ /usr/local/include/android-stream-manager/
    â””â”€â”€ *.h                        # Headers C++

================================================================================
PRÃ“XIMOS PASSOS APÃ“S INSTALAÃ‡ÃƒO
================================================================================

1. Configurar servidor de produÃ§Ã£o
2. Implementar autenticaÃ§Ã£o JWT
3. Configurar TLS/SSL
4. Implementar dashboard web (opcional)
5. Adicionar monitoramento
6. Configurar backup automÃ¡tico
7. Documentar APIs

================================================================================
SUPORTE E DOCUMENTAÃ‡ÃƒO
================================================================================

- DocumentaÃ§Ã£o: docs/ (quando implementada)
- Logs: /var/log/android-stream-manager/
- ConfiguraÃ§Ãµes: /etc/android-stream-manager/
- CÃ³digo fonte: src/, android-client-template/

Para suporte adicional, consulte:
- README.md (quando criado)
- Issues do GitHub
- DocumentaÃ§Ã£o tÃ©cnica nos arquivos .h

================================================================================
FIM DO TUTORIAL - SISTEMA PRONTO PARA USO!
================================================================================