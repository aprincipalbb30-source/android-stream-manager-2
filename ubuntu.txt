üöÄ Passo 1: Prepara√ß√£o do Ambiente
1.1. No Ubuntu/Linux:
bash
# Atualizar sistema
sudo apt update && sudo apt upgrade -y

# Instalar ferramentas b√°sicas
sudo apt install -y git curl wget build-essential cmake pkg-config
sudo apt install -y libssl-dev liblz4-dev libzip-dev zlib1g-dev
sudo apt install -y qt6-base-dev qt6-tools-dev qt6-multimedia-dev
sudo apt install -y libjwt-dev libavcodec-dev libavformat-dev libswscale-dev
sudo apt install -y default-jdk android-sdk android-sdk-build-tools
1.2. No Windows com WSL2:
powershell
# 1. Instalar WSL2 (se n√£o tiver)
wsl --install -d Ubuntu-22.04

# 2. No PowerShell como Administrador
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
Enable-WindowsOptionalFeature -Online -FeatureName VirtualMachinePlatform

# 3. Reiniciar e executar no WSL2:
wsl
1.3. Instalar Android SDK e NDK:
bash
# Criar diret√≥rio do Android SDK
mkdir -p ~/android-sdk
cd ~/android-sdk

# Baixar command line tools
wget https://dl.google.com/android/repository/commandlinetools-linux-9477386_latest.zip
unzip commandlinetools-linux-9477386_latest.zip
mv cmdline-tools tools

# Configurar vari√°veis de ambiente
echo 'export ANDROID_SDK_ROOT="$HOME/android-sdk"' >> ~/.bashrc
echo 'export ANDROID_NDK_HOME="$ANDROID_SDK_ROOT/ndk/25.2.9519653"' >> ~/.bashrc
echo 'export PATH="$PATH:$ANDROID_SDK_ROOT/tools/bin:$ANDROID_SDK_ROOT/platform-tools"' >> ~/.bashrc
source ~/.bashrc

# Instalar componentes necess√°rios
sdkmanager --install "platform-tools" "platforms;android-33" "build-tools;33.0.0"
sdkmanager --install "ndk;25.2.9519653" "cmake;3.22.1"
üõ†Ô∏è Passo 2: Clonar e Preparar o Projeto
bash
# Clonar reposit√≥rio
git clone https://github.com/seu-usuario/android-stream-manager.git
cd android-stream-manager

# Criar estrutura de diret√≥rios
mkdir -p {logs,cache,certs,templates,apk-output}
mkdir -p src/{core,dashboard,builder,security,compliance,optimization}
üìÅ Passo 3: Configurar Arquivos de C√≥digo
3.1. Estrutura final do projeto:
text
android-stream-manager/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ system_manager.cpp
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ system_manager.h
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main_window.cpp
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main_window.h
‚îÇ   ‚îú‚îÄ‚îÄ security/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tls_manager.cpp
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt_manager.cpp
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ apk_signer.cpp
‚îÇ   ‚îú‚îÄ‚îÄ compliance/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ compliance_manager.cpp
‚îÇ   ‚îú‚îÄ‚îÄ optimization/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ thread_pool.cpp
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ build_cache.cpp
‚îÇ   ‚îî‚îÄ‚îÄ shared/
‚îÇ       ‚îî‚îÄ‚îÄ protocol.h
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ system_config.json
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ android-client/
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ init_system.sh
‚îÇ   ‚îî‚îÄ‚îÄ generate_certs.sh
‚îú‚îÄ‚îÄ Makefile
‚îú‚îÄ‚îÄ CMakeLists.txt
‚îî‚îÄ‚îÄ README.md
3.2. Criar CMakeLists.txt principal:
cmake
cmake_minimum_required(VERSION 3.16)
project(AndroidStreamManager VERSION 1.0.0 LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)

# Op√ß√µes de build
option(BUILD_DASHBOARD "Build Qt Dashboard" ON)
option(BUILD_APK_BUILDER "Build APK Builder" ON)
option(BUILD_SERVER "Build Server Component" ON)

# Diret√≥rios
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)

# Incluir diret√≥rios
include_directories(${CMAKE_SOURCE_DIR}/src)
include_directories(${CMAKE_SOURCE_DIR}/src/shared)

# Encontrar pacotes
find_package(OpenSSL REQUIRED)
find_package(ZLIB REQUIRED)
find_package(LibLZ4 REQUIRED)
find_package(libzip REQUIRED)

if(BUILD_DASHBOARD)
    find_package(Qt6 REQUIRED COMPONENTS Core Widgets Network Multimedia)
endif()

# Configura√ß√µes espec√≠ficas do sistema
if(WIN32)
    add_definitions(-DWINDOWS_BUILD -D_CRT_SECURE_NO_WARNINGS)
    set(PLATFORM_LIBS ws2_32 crypt32)
else()
    add_definitions(-DLINUX_BUILD -D_GLIBCXX_USE_CXX11_ABI=1)
    set(PLATFORM_LIBS pthread dl)
endif()

# Biblioteca Core
add_library(core_lib STATIC
    src/core/system_manager.cpp
    src/security/tls_manager.cpp
    src/security/jwt_manager.cpp
    src/security/apk_signer.cpp
    src/compliance/compliance_manager.cpp
    src/optimization/thread_pool.cpp
    src/optimization/build_cache.cpp
    src/optimization/stream_optimizer.cpp
)

target_link_libraries(core_lib
    OpenSSL::SSL
    OpenSSL::Crypto
    ${ZLIB_LIBRARIES}
    LibLZ4::LibLZ4
    ${libzip_LIBRARIES}
    ${PLATFORM_LIBS}
)

# Dashboard (Qt)
if(BUILD_DASHBOARD)
    add_executable(android_stream_dashboard
        src/dashboard/main.cpp
        src/dashboard/main_window.cpp
        src/dashboard/apk_config_widget.cpp
        src/dashboard/device_control_panel.cpp
    )
    
    target_link_libraries(android_stream_dashboard
        core_lib
        Qt6::Core
        Qt6::Widgets
        Qt6::Network
        Qt6::Multimedia
    )
    
    # Resources
    qt_add_resources(dashboard_resources "dashboard_resources"
        resources/dashboard/icons.qrc
        resources/dashboard/styles.qrc
    )
    target_link_libraries(android_stream_dashboard dashboard_resources)
endif()

# APK Builder
if(BUILD_APK_BUILDER)
    add_executable(apk_builder
        src/builder/main.cpp
        src/builder/apk_generator.cpp
        src/builder/template_manager.cpp
    )
    
    target_link_libraries(apk_builder core_lib)
    
    # Configurar Android NDK
    if(ANDROID_NDK)
        set(ANDROID_NDK_PATH ${ANDROID_NDK})
        include_directories(${ANDROID_NDK_PATH}/sources/android/native_app_glue)
    endif()
endif()

# Instala√ß√£o
install(TARGETS core_lib DESTINATION lib)
if(BUILD_DASHBOARD)
    install(TARGETS android_stream_dashboard DESTINATION bin)
endif()
if(BUILD_APK_BUILDER)
    install(TARGETS apk_builder DESTINATION bin)
endif()

install(DIRECTORY config/ DESTINATION etc/android-stream-manager)
install(DIRECTORY templates/ DESTINATION share/android-stream-manager/templates)
üîê Passo 4: Configura√ß√£o de Seguran√ßa
4.1. Script de gera√ß√£o de certificados (scripts/generate_certs.sh):
bash
#!/bin/bash
# generate_certs.sh

CERT_DIR="./certs"
CONFIG_DIR="./config"

echo "=== Gerando Certificados de Seguran√ßa ==="

# Criar diret√≥rios
mkdir -p $CERT_DIR $CONFIG_DIR

# 1. Autoridade Certificadora (CA)
echo "1. Criando Autoridade Certificadora..."
openssl genrsa -out $CERT_DIR/ca.key 4096
openssl req -x509 -new -nodes -key $CERT_DIR/ca.key \
  -sha256 -days 3650 -out $CERT_DIR/ca.crt \
  -subj "/C=BR/ST=SP/L=Sao_Paulo/O=Corporation/CN=Android Stream Manager Root CA"

# 2. Certificado do Servidor
echo "2. Criando Certificado do Servidor..."
openssl genrsa -out $CERT_DIR/server.key 2048
openssl req -new -key $CERT_DIR/server.key -out $CERT_DIR/server.csr \
  -subj "/C=BR/ST=SP/L=Sao_Paulo/O=Corporation/CN=stream-server.local" \
  -addext "subjectAltName = DNS:stream-server.local, IP:127.0.0.1"

openssl x509 -req -in $CERT_DIR/server.csr \
  -CA $CERT_DIR/ca.crt -CAkey $CERT_DIR/ca.key -CAcreateserial \
  -out $CERT_DIR/server.crt -days 365 -sha256 \
  -extfile <(printf "subjectAltName=DNS:stream-server.local,IP:127.0.0.1")

# 3. Certificado do Cliente (Dashboard)
echo "3. Criando Certificado do Cliente..."
openssl genrsa -out $CERT_DIR/client.key 2048
openssl req -new -key $CERT_DIR/client.key -out $CERT_DIR/client.csr \
  -subj "/C=BR/ST=SP/L=Sao_Paulo/O=Corporation/CN=operator-dashboard"

openssl x509 -req -in $CERT_DIR/client.csr \
  -CA $CERT_DIR/ca.crt -CAkey $CERT_DIR/ca.key -CAcreateserial \
  -out $CERT_DIR/client.crt -days 365 -sha256

# 4. Keystore para assinatura de APKs
echo "4. Criando Keystore para assinatura..."
keytool -genkeypair -v \
  -keystore $CERT_DIR/signing.keystore \
  -alias android_stream \
  -keyalg RSA -keysize 2048 \
  -validity 10000 \
  -storepass "ChangeThisPassword123!" \
  -keypass "ChangeThisPassword123!" \
  -dname "CN=Android Stream, OU=Development, O=Corporation, C=BR"

# 5. Arquivo de configura√ß√£o de seguran√ßa
echo "5. Criando arquivo de configura√ß√£o..."
cat > $CONFIG_DIR/security_config.json << EOF
{
  "tls": {
    "ca_cert": "$CERT_DIR/ca.crt",
    "server_cert": "$CERT_DIR/server.crt",
    "server_key": "$CERT_DIR/server.key",
    "client_cert": "$CERT_DIR/client.crt",
    "client_key": "$CERT_DIR/client.key",
    "ciphers": [
      "TLS_AES_256_GCM_SHA384",
      "TLS_CHACHA20_POLY1305_SHA256",
      "TLS_AES_128_GCM_SHA256"
    ]
  },
  "jwt": {
    "secret_key": "$(openssl rand -base64 32)",
    "issuer": "android-stream-manager",
    "audience": "corporate-dashboard",
    "access_token_expiry": 3600,
    "refresh_token_expiry": 86400
  },
  "signing": {
    "keystore_path": "$CERT_DIR/signing.keystore",
    "keystore_password_env": "KEYSTORE_PASSWORD",
    "key_alias": "android_stream",
    "key_password_env": "KEY_PASSWORD"
  }
}
EOF

# 6. Permiss√µes de seguran√ßa
chmod 600 $CERT_DIR/*.key
chmod 600 $CERT_DIR/*.keystore
chmod 644 $CERT_DIR/*.crt

echo "=== Certificados gerados com sucesso! ==="
echo "Diret√≥rio: $CERT_DIR"
echo "Configura√ß√£o: $CONFIG_DIR/security_config.json"
Execute o script:

bash
chmod +x scripts/generate_certs.sh
./scripts/generate_certs.sh
4.2. Configurar vari√°veis de ambiente (.env):
bash
# .env file
# Configura√ß√µes de seguran√ßa
KEYSTORE_PASSWORD="ChangeThisPassword123!"
KEY_PASSWORD="ChangeThisPassword123!"
JWT_SECRET="$(openssl rand -base64 32)"

# Banco de dados
DB_HOST="localhost"
DB_PORT="5432"
DB_NAME="stream_manager"
DB_USER="stream_admin"
DB_PASSWORD="SecureDbPass123!"

# Servidor
SERVER_HOST="0.0.0.0"
SERVER_PORT="8443"
SERVER_SSL_ENABLED="true"

# Android SDK
ANDROID_SDK_ROOT="$HOME/android-sdk"
ANDROID_HOME="$ANDROID_SDK_ROOT"
ANDROID_NDK_HOME="$ANDROID_SDK_ROOT/ndk/25.2.9519653"

# Caminhos
TEMPLATES_DIR="./templates"
APK_OUTPUT_DIR="./apk-output"
CACHE_DIR="./cache"
LOGS_DIR="./logs"
Carregar no shell:

bash
# Criar arquivo .env
cp .env.example .env
# Editar com suas configura√ß√µes
nano .env

# Carregar vari√°veis
set -a
source .env
set +a
üèóÔ∏è Passo 5: Build do Sistema
5.1. Makefile atualizado:
makefile
# Makefile
.PHONY: all clean install build test setup deps

# Configura√ß√µes
BUILD_TYPE ?= Release
BUILD_DIR = build
INSTALL_DIR = /opt/android-stream-manager
CONFIG_DIR = /etc/android-stream-manager

all: deps build

# Depend√™ncias
deps:
	@echo "Instalando depend√™ncias..."
	sudo apt-get update
	sudo apt-get install -y \
		build-essential cmake ninja-build \
		libssl-dev liblz4-dev libzip-dev \
		qt6-base-dev qt6-tools-dev qt6-multimedia-dev \
		libjwt-dev libavcodec-dev libavformat-dev \
		default-jdk android-sdk

# Configura√ß√£o
configure:
	@echo "Configurando build..."
	mkdir -p $(BUILD_DIR)
	cd $(BUILD_DIR) && \
	cmake .. \
		-DCMAKE_BUILD_TYPE=$(BUILD_TYPE) \
		-DBUILD_DASHBOARD=ON \
		-DBUILD_APK_BUILDER=ON \
		-DBUILD_SERVER=ON \
		-G Ninja

# Build
build: configure
	@echo "Compilando..."
	cd $(BUILD_DIR) && ninja

# Build r√°pido (desenvolvimento)
dev:
	@echo "Build de desenvolvimento..."
	mkdir -p $(BUILD_DIR)
	cd $(BUILD_DIR) && \
	cmake .. -DCMAKE_BUILD_TYPE=Debug -GNinja && \
	ninja

# Build de release
release:
	@echo "Build de release..."
	$(MAKE) BUILD_TYPE=Release build

# Instala√ß√£o
install: build
	@echo "Instalando sistema..."
	sudo mkdir -p $(INSTALL_DIR) $(CONFIG_DIR)
	sudo cp -r $(BUILD_DIR)/bin/* $(INSTALL_DIR)/
	sudo cp -r config/* $(CONFIG_DIR)/
	sudo cp -r templates $(INSTALL_DIR)/
	sudo chmod +x $(INSTALL_DIR)/*
	
	# Criar usu√°rio e grupo
	sudo groupadd -f stream-manager
	sudo useradd -r -s /bin/false -g stream-manager stream-manager
	
	# Configurar permiss√µes
	sudo chown -R stream-manager:stream-manager $(INSTALL_DIR) $(CONFIG_DIR)
	sudo chmod 750 $(INSTALL_DIR) $(CONFIG_DIR)
	
	# Instalar servi√ßo systemd
	sudo cp scripts/android-stream-manager.service /etc/systemd/system/
	sudo systemctl daemon-reload
	
	@echo "Instala√ß√£o completa!"
	@echo "Configure o arquivo: $(CONFIG_DIR)/system_config.json"
	@echo "Inicie com: sudo systemctl start android-stream-manager"

# Desinstalar
uninstall:
	@echo "Desinstalando..."
	sudo systemctl stop android-stream-manager || true
	sudo systemctl disable android-stream-manager || true
	sudo rm -f /etc/systemd/system/android-stream-manager.service
	sudo rm -rf $(INSTALL_DIR) $(CONFIG_DIR)
	sudo userdel stream-manager || true
	sudo groupdel stream-manager || true

# Limpar
clean:
	@echo "Limpando..."
	rm -rf $(BUILD_DIR)
	rm -f *.apk
	rm -rf cache/*

# Testes
test: build
	@echo "Executando testes..."
	cd $(BUILD_DIR) && ctest --output-on-failure

# Executar dashboard
run-dashboard: build
	@echo "Executando dashboard..."
	$(BUILD_DIR)/bin/android_stream_dashboard

# Package (DEB/RPM)
package: release
	@echo "Criando pacote..."
	cd $(BUILD_DIR) && cpack -G DEB

# Help
help:
	@echo "Comandos dispon√≠veis:"
	@echo "  make deps      - Instalar depend√™ncias"
	@echo "  make build     - Compilar sistema"
	@echo "  make dev       - Build de desenvolvimento"
	@echo "  make release   - Build de produ√ß√£o"
	@echo "  make install   - Instalar sistema"
	@echo "  make uninstall - Remover sistema"
	@echo "  make clean     - Limpar arquivos de build"
	@echo "  make test      - Executar testes"
	@echo "  make run-dashboard - Executar dashboard"
	@echo "  make package   - Criar pacote DEB"
5.2. Executar o build:
bash
# 1. Instalar depend√™ncias
make deps

# 2. Build do sistema
make build

# Ou para desenvolvimento
make dev

# 3. Testar dashboard
make run-dashboard
‚öôÔ∏è Passo 6: Configura√ß√£o do Sistema
6.1. Arquivo de configura√ß√£o principal (config/system_config.json):
json
{
  "application": {
    "name": "Android Stream Manager",
    "version": "1.0.0",
    "mode": "production",
    "log_level": "info"
  },
  
  "server": {
    "host": "0.0.0.0",
    "port": 8443,
    "max_connections": 1000,
    "session_timeout": 1800,
    "enable_compression": true,
    "cors_origins": ["http://localhost:3000"]
  },
  
  "security": {
    "tls_enabled": true,
    "require_client_cert": true,
    "min_tls_version": "1.3",
    "certificate_file": "/etc/android-stream-manager/certs/server.crt",
    "private_key_file": "/etc/android-stream-manager/certs/server.key",
    "ca_certificate_file": "/etc/android-stream-manager/certs/ca.crt",
    
    "jwt": {
      "secret_key_env": "JWT_SECRET",
      "issuer": "android-stream-manager",
      "audience": "corporate-dashboard",
      "access_token_expiry": 3600,
      "refresh_token_expiry": 2592000
    },
    
    "encryption": {
      "algorithm": "aes-256-gcm",
      "key_rotation_days": 7
    }
  },
  
  "apk_builder": {
    "android_sdk_path": "/home/user/android-sdk",
    "template_dir": "/opt/android-stream-manager/templates",
    "output_dir": "/var/lib/android-stream-manager/apks",
    "signing_keystore": "/etc/android-stream-manager/certs/signing.keystore",
    "signing_alias": "android_stream",
    
    "default_config": {
      "min_sdk_version": 23,
      "target_sdk_version": 33,
      "compile_sdk_version": 33,
      "package_prefix": "com.corporation.stream",
      "default_icon": "/opt/android-stream-manager/templates/icon.png"
    },
    
    "permissions": {
      "required": ["INTERNET", "ACCESS_NETWORK_STATE"],
      "optional": ["CAMERA", "RECORD_AUDIO", "READ_EXTERNAL_STORAGE"]
    }
  },
  
  "dashboard": {
    "theme": "dark",
    "auto_refresh_interval": 5000,
    "max_log_lines": 1000,
    "enable_audio_alerts": true,
    
    "views": {
      "dashboard": true,
      "device_control": true,
      "apk_builder": true,
      "logs": true,
      "analytics": true
    }
  },
  
  "database": {
    "type": "sqlite",
    "path": "/var/lib/android-stream-manager/database.db",
    
    "sqlite": {
      "journal_mode": "WAL",
      "synchronous": "NORMAL",
      "cache_size": -2000,
      "busy_timeout": 5000
    },
    
    "tables": {
      "devices": true,
      "sessions": true,
      "apk_builds": true,
      "audit_logs": true,
      "users": true
    }
  },
  
  "cache": {
    "enabled": true,
    "type": "memory",
    "max_size_mb": 1024,
    "ttl_seconds": 3600,
    
    "redis": {
      "host": "localhost",
      "port": 6379,
      "password": "",
      "database": 0
    }
  },
  
  "compliance": {
    "require_consent": true,
    "consent_duration_hours": 24,
    "max_session_hours": 8,
    "data_retention_days": 90,
    "audit_logging": true,
    
    "restrictions": {
      "max_devices_per_operator": 50,
      "max_sessions_per_day": 100,
      "allow_remote_access": false,
      "allow_screen_recording": true,
      "allow_audio_capture": true
    }
  },
  
  "logging": {
    "console": {
      "enabled": true,
      "level": "info",
      "format": "json"
    },
    
    "file": {
      "enabled": true,
      "path": "/var/log/android-stream-manager",
      "max_size_mb": 100,
      "max_files": 10,
      "compress": true
    },
    
    "syslog": {
      "enabled": false,
      "address": "localhost:514"
    }
  },
  
  "monitoring": {
    "enabled": true,
    "prometheus_port": 9090,
    "metrics_interval": 30,
    
    "alerts": {
      "high_cpu_threshold": 80,
      "high_memory_threshold": 85,
      "disk_space_threshold": 90,
      "max_active_sessions": 100
    }
  },
  
  "backup": {
    "enabled": true,
    "schedule": "0 2 * * *",
    "retention_days": 30,
    "path": "/var/backup/android-stream-manager",
    
    "include": [
      "database",
      "config",
      "certificates",
      "apk_builds"
    ]
  }
}
6.2. Script de inicializa√ß√£o do sistema (scripts/init_system.sh):
bash
#!/bin/bash
# init_system.sh - Script completo de inicializa√ß√£o

set -e

# Cores para output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo -e "${GREEN}=== Inicializa√ß√£o do Android Stream Manager ===${NC}"

# 1. Verificar root
if [ "$EUID" -ne 0 ]; then 
    echo -e "${RED}Por favor, execute como root (sudo)${NC}"
    exit 1
fi

# 2. Criar diret√≥rios necess√°rios
echo "Criando estrutura de diret√≥rios..."
mkdir -p /opt/android-stream-manager
mkdir -p /etc/android-stream-manager/{certs,config}
mkdir -p /var/lib/android-stream-manager/{apks,database,sessions,cache}
mkdir -p /var/log/android-stream-manager
mkdir -p /var/backup/android-stream-manager
mkdir -p /usr/local/share/android-stream-manager/templates

# 3. Copiar arquivos do build
echo "Copiando arquivos do sistema..."
if [ -d "build/bin" ]; then
    cp -r build/bin/* /opt/android-stream-manager/
else
    echo -e "${YELLOW}Aviso: Diret√≥rio build/bin n√£o encontrado. Execute 'make build' primeiro.${NC}"
fi

# 4. Copiar configura√ß√µes
cp -r config/* /etc/android-stream-manager/config/
cp -r templates/* /usr/local/share/android-stream-manager/templates/

# 5. Criar usu√°rio e grupo
echo "Configurando usu√°rio do sistema..."
if ! getent group stream-manager > /dev/null; then
    groupadd --system stream-manager
fi

if ! id -u stream-manager > /dev/null 2>&1; then
    useradd --system --no-create-home --gid stream-manager --shell /bin/false \
        --comment "Android Stream Manager Service" stream-manager
fi

# 6. Configurar permiss√µes
echo "Configurando permiss√µes..."
chown -R stream-manager:stream-manager \
    /opt/android-stream-manager \
    /var/lib/android-stream-manager \
    /var/log/android-stream-manager \
    /etc/android-stream-manager

chmod 750 /opt/android-stream-manager
chmod 750 /var/lib/android-stream-manager
chmod 640 /etc/android-stream-manager/certs/*.key 2>/dev/null || true
chmod 644 /etc/android-stream-manager/certs/*.crt 2>/dev/null || true

# 7. Configurar firewall (se dispon√≠vel)
echo "Configurando firewall..."
if command -v ufw &> /dev/null; then
    ufw allow 8443/tcp comment "Android Stream Manager HTTPS"
    ufw allow 9090/tcp comment "Prometheus Metrics"
    echo -e "${GREEN}Firewall configurado${NC}"
fi

# 8. Instalar servi√ßo systemd
echo "Instalando servi√ßo systemd..."
cat > /etc/systemd/system/android-stream-manager.service << 'EOF'
[Unit]
Description=Android Stream Manager Service
After=network.target
Requires=network.target
StartLimitIntervalSec=0

[Service]
Type=simple
Restart=always
RestartSec=5
User=stream-manager
Group=stream-manager
WorkingDirectory=/opt/android-stream-manager
EnvironmentFile=/etc/default/android-stream-manager

# Configura√ß√µes de seguran√ßa
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/lib/android-stream-manager /var/log/android-stream-manager

# Limites de recursos
LimitNOFILE=65536
LimitNPROC=4096
LimitCORE=0

# Comando de execu√ß√£o
ExecStart=/opt/android-stream-manager/android_stream_dashboard --config /etc/android-stream-manager/config/system_config.json

# Logs
StandardOutput=journal
StandardError=journal
SyslogIdentifier=android-stream-manager

[Install]
WantedBy=multi-user.target
EOF

# 9. Criar arquivo de ambiente
echo "Criando arquivo de ambiente..."
cat > /etc/default/android-stream-manager << 'EOF'
# Configura√ß√µes de ambiente do Android Stream Manager
ANDROID_SDK_ROOT=/home/user/android-sdk
ANDROID_HOME=$ANDROID_SDK_ROOT
JWT_SECRET="your-jwt-secret-here-change-this"
KEYSTORE_PASSWORD="ChangeThisPassword123!"
KEY_PASSWORD="ChangeThisPassword123!"

# Logging
LOG_LEVEL=info
LOG_DIR=/var/log/android-stream-manager

# Database
DB_PATH=/var/lib/android-stream-manager/database.db
EOF

echo -e "${YELLOW}Edite /etc/default/android-stream-manager com suas configura√ß√µes${NC}"

# 10. Recarregar systemd
systemctl daemon-reload
systemctl enable android-stream-manager.service

# 11. Criar script de backup
echo "Criando script de backup..."
cat > /usr/local/bin/backup-stream-manager << 'EOF'
#!/bin/bash
BACKUP_DIR="/var/backup/android-stream-manager"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="$BACKUP_DIR/backup_$TIMESTAMP.tar.gz"

echo "Criando backup em: $BACKUP_FILE"
tar -czf "$BACKUP_FILE" \
    /etc/android-stream-manager \
    /var/lib/android-stream-manager/database.db \
    /var/lib/android-stream-manager/apks \
    2>/dev/null

# Limpar backups antigos (mais de 30 dias)
find "$BACKUP_DIR" -name "backup_*.tar.gz" -mtime +30 -delete

echo "Backup completo: $BACKUP_FILE"
EOF

chmod +x /usr/local/bin/backup-stream-manager

# 12. Criar crontab para backups
echo "Configurando backup autom√°tico..."
(crontab -l 2>/dev/null; echo "0 2 * * * /usr/local/bin/backup-stream-manager") | crontab -

# 13. Instalar p√°gina de status web (opcional)
echo "Instalando p√°gina de status web..."
if [ -f "scripts/status.html" ]; then
    cp scripts/status.html /var/www/html/stream-manager-status.html
    chown www-data:www-data /var/www/html/stream-manager-status.html
fi

echo -e "${GREEN}=== Inicializa√ß√£o completa! ===${NC}"
echo ""
echo -e "${YELLOW}Pr√≥ximos passos:${NC}"
echo "1. Edite /etc/default/android-stream-manager"
echo "2. Execute: sudo systemctl start android-stream-manager"
echo "3. Verifique logs: sudo journalctl -u android-stream-manager -f"
echo "4. Acesse: https://localhost:8443 (ignore o aviso SSL)"
echo ""
echo -e "${GREEN}Para gerar certificados v√°lidos:${NC}"
echo "Execute: ./scripts/generate_certs.sh"
Torne execut√°vel e execute:

bash
chmod +x scripts/init_system.sh
sudo ./scripts/init_system.sh
üö¶ Passo 7: Iniciar e Testar o Sistema
7.1. Iniciar o servi√ßo:
bash
# 1. Iniciar servi√ßo
sudo systemctl start android-stream-manager

# 2. Verificar status
sudo systemctl status android-stream-manager

# 3. Habilitar inicializa√ß√£o autom√°tica
sudo systemctl enable android-stream-manager

# 4. Verificar logs em tempo real
sudo journalctl -u android-stream-manager -f
7.2. Testar conectividade:
bash
# Testar porta HTTPS
curl -k https://localhost:8443/api/health

# Testar com certificado
curl --cacert certs/ca.crt --cert certs/client.crt --key certs/client.key \
  https://localhost:8443/api/status
7.3. Script de teste (scripts/test_system.sh):
bash
#!/bin/bash
# test_system.sh

echo "=== Testando Android Stream Manager ==="

# 1. Testar se o servi√ßo est√° rodando
if ! systemctl is-active --quiet android-stream-manager; then
    echo "‚ùå Servi√ßo n√£o est√° rodando"
    exit 1
fi
echo "‚úÖ Servi√ßo est√° ativo"

# 2. Testar porta HTTPS
if ! nc -z localhost 8443; then
    echo "‚ùå Porta 8443 n√£o est√° ouvindo"
    exit 1
fi
echo "‚úÖ Porta 8443 est√° aberta"

# 3. Testar API de sa√∫de
HEALTH_RESPONSE=$(curl -s -k https://localhost:8443/api/health)
if echo "$HEALTH_RESPONSE" | grep -q '"status":"ok"'; then
    echo "‚úÖ API de sa√∫de respondendo"
else
    echo "‚ùå API de sa√∫de falhou: $HEALTH_RESPONSE"
fi

# 4. Testar banco de dados
if [ -f "/var/lib/android-stream-manager/database.db" ]; then
    DB_SIZE=$(stat -c%s "/var/lib/android-stream-manager/database.db")
    if [ "$DB_SIZE" -gt 0 ]; then
        echo "‚úÖ Banco de dados existe e tem $DB_SIZE bytes"
    else
        echo "‚ö†Ô∏è Banco de dados vazio"
    fi
fi

# 5. Testar diret√≥rios
DIRS=(
    "/opt/android-stream-manager"
    "/var/lib/android-stream-manager"
    "/var/log/android-stream-manager"
    "/etc/android-stream-manager"
)

for dir in "${DIRS[@]}"; do
    if [ -d "$dir" ]; then
        echo "‚úÖ Diret√≥rio $dir existe"
    else
        echo "‚ùå Diret√≥rio $dir n√£o existe"
    fi
done

# 6. Testar permiss√µes
USER_CHECK=$(stat -c '%U:%G' /opt/android-stream-manager 2>/dev/null)
if [ "$USER_CHECK" = "stream-manager:stream-manager" ]; then
    echo "‚úÖ Permiss√µes do usu√°rio corretas"
else
    echo "‚ùå Permiss√µes incorretas: $USER_CHECK"
fi

# 7. Testar certificados
CERT_FILES=(
    "/etc/android-stream-manager/certs/server.crt"
    "/etc/android-stream-manager/certs/server.key"
    "/etc/android-stream-manager/certs/ca.crt"
)

for cert in "${CERT_FILES[@]}"; do
    if [ -f "$cert" ]; then
        echo "‚úÖ Certificado $cert existe"
    else
        echo "‚ö†Ô∏è Certificado $cert n√£o encontrado"
    fi
done

echo "=== Teste completo ==="
Execute:

bash
chmod +x scripts/test_system.sh
sudo ./scripts/test_system.sh
üì± Passo 8: Configurar Primeiro APK
8.1. Template APK b√°sico:
Crie o diret√≥rio de template:

bash
mkdir -p templates/android-client-base
Estrutura do template:

text
templates/android-client-base/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ src/main/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ java/com/stream/client/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MainActivity.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StreamingService.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ NetworkManager.java
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ res/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/activity_main.xml
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ values/strings.xml
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AndroidManifest.xml
‚îú‚îÄ‚îÄ build.gradle
‚îî‚îÄ‚îÄ gradle.properties
8.2. Script para criar template (scripts/create_template.sh):
bash
#!/bin/bash
# create_template.sh

TEMPLATE_DIR="templates/android-client-base"

echo "Criando template APK base..."

mkdir -p $TEMPLATE_DIR/app/src/main/java/com/stream/client
mkdir -p $TEMPLATE_DIR/app/src/main/res/layout
mkdir -p $TEMPLATE_DIR/app/src/main/res/values

# AndroidManifest.xml
cat > $TEMPLATE_DIR/app/src/main/AndroidManifest.xml << 'EOF'
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="{{PACKAGE_NAME}}">

    <!-- PERMISSIONS_PLACEHOLDER -->
    
    <application
        android:name=".StreamingApplication"
        android:icon="{{APP_ICON}}"
        android:label="{{APP_NAME}}"
        android:theme="@style/AppTheme"
        android:allowBackup="false">
        
        <activity android:name=".MainActivity"
            android:exported="true"
            android:theme="@style/AppTheme.NoActionBar">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        
        <service
            android:name=".StreamingService"
            android:enabled="true"
            android:exported="false"
            android:foregroundServiceType="mediaProjection|camera|microphone">
            
            <!-- SERVICE_CONFIG_PLACEHOLDER -->
            
        </service>
        
        <meta-data
            android:name="SERVER_CONFIG"
            android:value="{{SERVER_CONFIG}}" />
            
    </application>
</manifest>
EOF

# MainActivity.java
cat > $TEMPLATE_DIR/app/src/main/java/com/stream/client/MainActivity.java << 'EOF'
package com.stream.client;

import android.os.Bundle;
import androidx.appcompat.app.AppCompatActivity;

public class MainActivity extends AppCompatActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        
        // Iniciar servi√ßo de streaming
        StreamingService.start(this);
    }
}
EOF

# build.gradle
cat > $TEMPLATE_DIR/build.gradle << 'EOF'
// Top-level build file
buildscript {
    repositories {
        google()
        mavenCentral()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:7.4.2'
    }
}

allprojects {
    repositories {
        google()
        mavenCentral()
    }
}

task clean(type: Delete) {
    delete rootProject.buildDir
}
EOF

# app/build.gradle
cat > $TEMPLATE_DIR/app/build.gradle << 'EOF'
plugins {
    id 'com.android.application'
}

android {
    namespace '{{PACKAGE_NAME}}'
    compileSdk {{COMPILE_SDK_VERSION}}

    defaultConfig {
        applicationId "{{PACKAGE_NAME}}"
        minSdk {{MIN_SDK_VERSION}}
        targetSdk {{TARGET_SDK_VERSION}}
        versionCode {{VERSION_CODE}}
        versionName "{{VERSION_NAME}}"
    }

    buildTypes {
        release {
            minifyEnabled true
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
            signingConfig signingConfigs.release
        }
        debug {
            debuggable true
        }
    }
    
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
}

dependencies {
    implementation 'androidx.appcompat:appcompat:1.6.1'
    implementation 'com.google.android.material:material:1.9.0'
    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'
    
    // Networking
    implementation 'com.squareup.okhttp3:okhttp:4.11.0'
    implementation 'com.google.code.gson:gson:2.10.1'
    
    // WebSocket
    implementation 'org.java-websocket:Java-WebSocket:1.5.3'
}
EOF

echo "‚úÖ Template criado em: $TEMPLATE_DIR"
Execute:

bash
chmod +x scripts/create_template.sh
./scripts/create_template.sh
üîß Passo 9: Configura√ß√£o Avan√ßada
9.1. Configurar Nginx como proxy reverso (opcional):
bash
sudo apt install nginx
Configura√ß√£o do Nginx (/etc/nginx/sites-available/stream-manager):

nginx
upstream stream_manager_backend {
    server 127.0.0.1:8443;
    keepalive 32;
}

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    
    server_name stream-manager.your-domain.com;
    
    # SSL Configuration
    ssl_certificate /etc/nginx/ssl/stream-manager.crt;
    ssl_certificate_key /etc/nginx/ssl/stream-manager.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
    ssl_prefer_server_ciphers off;
    
    # Security headers
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection "1; mode=block";
    add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
    
    # Proxy settings
    location / {
        proxy_pass https://stream_manager_backend;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        proxy_read_timeout 3600s;
        proxy_send_timeout 3600s;
        
        # Buffering
        proxy_buffering off;
        proxy_buffer_size 16k;
        proxy_buffers 4 16k;
    }
    
    # Static files
    location /static/ {
        alias /opt/android-stream-manager/static/;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # API
    location /api/ {
        proxy_pass https://stream_manager_backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        
        limit_req zone=api burst=20 nodelay;
        limit_req_status 429;
    }
}

# Rate limiting
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
Habilitar site:

bash
sudo ln -s /etc/nginx/sites-available/stream-manager /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
9.2. Configurar monitoramento com Prometheus:
yaml
# prometheus.yml
scrape_configs:
  - job_name: 'android-stream-manager'
    static_configs:
      - targets: ['localhost:9090']
    metrics_path: '/metrics'
    scheme: 'https'
    tls_config:
      ca_file: '/etc/prometheus/ca.crt'
      cert_file: '/etc/prometheus/client.crt'
      key_file: '/etc/prometheus/client.key'
      insecure_skip_verify: false
9.3. Script de manuten√ß√£o (scripts/maintenance.sh):
bash
#!/bin/bash
# maintenance.sh

LOG_FILE="/var/log/android-stream-manager/maintenance.log"
BACKUP_DIR="/var/backup/android-stream-manager"

log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

# 1. Backup di√°rio
backup_database() {
    log "Iniciando backup do banco de dados..."
    BACKUP_FILE="$BACKUP_DIR/db_backup_$(date +%Y%m%d_%H%M%S).sql.gz"
    
    if [ -f "/var/lib/android-stream-manager/database.db" ]; then
        sqlite3 "/var/lib/android-stream-manager/database.db" .dump | gzip > "$BACKUP_FILE"
        
        if [ $? -eq 0 ]; then
            log "Backup criado: $BACKUP_FILE"
            # Manter apenas √∫ltimos 7 backups
            find "$BACKUP_DIR" -name "db_backup_*.sql.gz" -mtime +7 -delete
        else
            log "ERRO: Falha ao criar backup"
        fi
    else
        log "Banco de dados n√£o encontrado"
    fi
}

# 2. Limpeza de cache
clean_cache() {
    log "Limpando cache..."
    CACHE_DIR="/var/lib/android-stream-manager/cache"
    
    if [ -d "$CACHE_DIR" ]; then
        # Remover arquivos com mais de 30 dias
        find "$CACHE_DIR" -type f -mtime +30 -delete
        find "$CACHE_DIR" -type d -empty -delete
        
        log "Cache limpo"
    fi
}

# 3. Rota√ß√£o de logs
rotate_logs() {
    log "Rotacionando logs..."
    
    # Log do sistema
    if [ -f "/var/log/android-stream-manager/system.log" ]; then
        mv "/var/log/android-stream-manager/system.log" \
           "/var/log/android-stream-manager/system.log.$(date +%Y%m%d)"
        touch "/var/log/android-stream-manager/system.log"
        chown stream-manager:stream-manager "/var/log/android-stream-manager/system.log"
    fi
    
    # Limpar logs antigos (mais de 30 dias)
    find "/var/log/android-stream-manager" -name "*.log.*" -mtime +30 -delete
}

# 4. Verificar espa√ßo em disco
check_disk_space() {
    log "Verificando espa√ßo em disco..."
    
    DISK_USAGE=$(df -h /var/lib | tail -1 | awk '{print $5}' | sed 's/%//')
    if [ "$DISK_USAGE" -gt 90 ]; then
        log "ALERTA: Uso de disco em $DISK_USAGE%"
        # Limpar APKs antigos
        find "/var/lib/android-stream-manager/apks" -name "*.apk" -mtime +7 -delete
    fi
}

# 5. Verificar sa√∫de do servi√ßo
check_service_health() {
    log "Verificando sa√∫de do servi√ßo..."
    
    if systemctl is-active --quiet android-stream-manager; then
        log "Servi√ßo est√° ativo"
        # Testar API
        RESPONSE=$(curl -s -k https://localhost:8443/api/health || echo "ERROR")
        if echo "$RESPONSE" | grep -q '"status":"ok"'; then
            log "API respondendo corretamente"
        else
            log "ALERTA: API n√£o est√° respondendo"
            systemctl restart android-stream-manager
        fi
    else
        log "ALERTA: Servi√ßo n√£o est√° rodando. Reiniciando..."
        systemctl start android-stream-manager
    fi
}

# Executar todas as tarefas
main() {
    log "=== Iniciando manuten√ß√£o ==="
    
    backup_database
    clean_cache
    rotate_logs
    check_disk_space
    check_service_health
    
    log "=== Manuten√ß√£o conclu√≠da ==="
}

main
Adicionar ao crontab:

bash
# Executar manuten√ß√£o di√°ria √†s 3 AM
0 3 * * * /opt/android-stream-manager/scripts/maintenance.sh
üéØ Passo 10: Primeiro Uso - Tutorial
10.1. Acessar o Dashboard:
Iniciar o sistema:

bash
sudo systemctl start android-stream-manager
Acessar no navegador:

text
https://localhost:8443
Ignorar aviso SSL (usar certificados auto-assinados)

Login inicial:

text
Usu√°rio: admin
Senha: admin123
Alterar na primeira entrada!

10.2. Criar primeiro APK:
No dashboard, ir para "APK Builder"

Configurar:

Nome do App: "Monitor Corporativo"

Package: com.empresa.monitor

Servidor: IP da sua m√°quina

Permiss√µes: Selecionar necess√°rias

√çcone: Upload de imagem

Clicar em "Build APK"

Aguardar constru√ß√£o (2-5 minutos)

Baixar APK ou gerar QR Code

10.3. Instalar no dispositivo Android:
bash
# M√©todo 1: ADB
adb install -r /caminho/do/apk/app-release.apk

# M√©todo 2: QR Code
# - Escanear QR Code do dashboard
# - Instalar via navegador

# M√©todo 3: Link de download
# - Acessar link fornecido
# - Baixar e instalar
10.4. Conectar dispositivo:
Abrir app no Android

Aceitar permiss√µes

App se conecta automaticamente

Aparecer√° no dashboard em "Dispositivos Conectados"

10.5. Iniciar streaming:
Selecionar dispositivo na lista

Clicar em "Iniciar Stream"

Visualizar em tempo real

Usar controles: pausar, qualidade, √°udio

üö® Solu√ß√£o de Problemas Comuns
Problema 1: Build falha
bash
# Verificar depend√™ncias
ldd build/bin/android_stream_dashboard

# Verificar logs de build
cat build/CMakeFiles/CMakeOutput.log

# Reinstalar depend√™ncias
sudo apt install --reinstall libssl-dev libqt6core6
Problema 2: Servi√ßo n√£o inicia
bash
# Verificar logs
sudo journalctl -u android-stream-manager -xe

# Verificar certificados
openssl x509 -in /etc/android-stream-manager/certs/server.crt -text -noout

# Testar manualmente
sudo -u stream-manager /opt/android-stream-manager/android_stream_dashboard --help
Problema 3: APK n√£o constr√≥i
bash
# Verificar Android SDK
echo $ANDROID_SDK_ROOT
sdkmanager --list

# Testar build manual
cd templates/android-client-base
./gradlew assembleDebug

# Verificar espa√ßo em disco
df -h
Problema 4: Conex√£o SSL recusada
bash
# Testar com curl
curl -v https://localhost:8443

# Verificar porta
netstat -tlnp | grep 8443

# Regenerar certificados
./scripts/generate_certs.sh
sudo systemctl restart android-stream-manager
Problema 5: Dashboard n√£o carrega
bash
# Verificar Qt
export QT_DEBUG_PLUGINS=1
/opt/android-stream-manager/android_stream_dashboard

# Instalar plugins Qt
sudo apt install qt6-base-dev qt6-multimedia-dev
üìä Monitoramento e Manuten√ß√£o
Comandos √∫teis para administra√ß√£o:
bash
# Ver status completo
sudo systemctl status android-stream-manager

# Ver logs em tempo real
sudo journalctl -u android-stream-manager -f

# Ver m√©tricas
curl -k https://localhost:8443/api/metrics | jq .

# Backup manual
/usr/local/bin/backup-stream-manager

# Reiniciar com limpeza
sudo systemctl restart android-stream-manager
sudo journalctl --rotate
sudo journalctl --vacuum-time=1d

# Espa√ßo usado por APKs
du -sh /var/lib/android-stream-manager/apks/*

# Usu√°rios conectados
sqlite3 /var/lib/android-stream-manager/database.db \
  "SELECT COUNT(*) FROM active_sessions;"
Dashboard de monitoramento web:
Crie um arquivo HTML simples em /var/www/html/monitor.html:

html
<!DOCTYPE html>
<html>
<head>
    <title>Stream Manager Monitor</title>
    <meta http-equiv="refresh" content="30">
    <style>
        body { font-family: Arial; margin: 20px; }
        .status { padding: 10px; margin: 5px; border-radius: 5px; }
        .healthy { background: #d4edda; }
        .warning { background: #fff3cd; }
        .error { background: #f8d7da; }
    </style>
</head>
<body>
    <h1>Android Stream Manager Monitor</h1>
    <div id="status"></div>
    <script>
        async function loadStatus() {
            try {
                const response = await fetch('https://localhost:8443/api/status', {
                    mode: 'no-cors'
                });
                const data = await response.json();
                updateDisplay(data);
            } catch (error) {
                document.getElementById('status').innerHTML = 
                    '<div class="status error">Erro ao carregar status</div>';
            }
        }
        
        function updateDisplay(data) {
            let html = `
                <div class="status ${data.healthy ? 'healthy' : 'error'}">
                    Status: ${data.healthy ? 'SAUD√ÅVEL' : 'COM PROBLEMAS'}
                </div>
                <div class="status">
                    Dispositivos: ${data.devices_connected}
                </div>
                <div class="status">
                    APKs Gerados: ${data.apks_built}
                </div>
                <div class="status">
                    Uptime: ${data.uptime}
                </div>
            `;
            document.getElementById('status').innerHTML = html;
        }
        
        loadStatus();
    </script>
</body>
</html>
üéâ Parab√©ns! Sistema Instalado
Seu sistema Android Stream Manager est√° agora completamente instalado e configurado.

Resumo do que foi feito:

‚úÖ Ambiente preparado com todas depend√™ncias

‚úÖ Sistema compilado com Make/CMake

‚úÖ Certificados de seguran√ßa gerados

‚úÖ Servi√ßo systemd configurado

‚úÖ Dashboard funcionando

‚úÖ Template APK criado

‚úÖ Backup e manuten√ß√£o automatizados

‚úÖ Monitoramento configurado

Pr√≥ximos passos recomendados:

Personalizar configura√ß√µes em /etc/android-stream-manager/config/

Substituir certificados por emitidos por uma CA real

Configurar dom√≠nio e proxy reverso (Nginx)

Integrar com LDAP/AD para autentica√ß√£o

Configurar alertas (Email, Slack, Telegram)

Implementar backup remoto (S3, FTP)

Links importantes:

Dashboard: https://seu-servidor:8443

API Status: https://seu-servidor:8443/api/health

M√©tricas: https://seu-servidor:9090/metrics

Logs: sudo journalctl -u android-stream-manager

Para suporte:

bash
# Verificar se tudo est√° funcionando
./scripts/test_system.sh

# Reiniciar completamente
sudo systemctl restart android-stream-manager

# Ver todos os logs
sudo journalctl -u android-stream-manager --since "1 hour ago"
O sistema est√° pronto para uso em ambientes corporativos, laborat√≥rios e educa√ß√£o!